{% extends "lm_test/base.html" %}
{% load staticfiles %}
{% block content %}
<h1>Bar Chart</h1>
<a href="{% static 'lm_test/temp.csv' %}">CSV File</a>
<script src="http://d3js.org/d3.v4.min.js"></script>
<script>
var margin = {top:50, right:50, bottom:50, left:50};
var width = 600 - margin.left - margin.right;
var height = 600 - margin.top - margin.bottom;

var svg = d3.select("#visualization").append("svg")
    .attr("width", width+margin.left+margin.right)
    .attr("height", height+margin.top+margin.bottom)
    .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");
var x = d3.scaleBand()
    .range([0, width])
var y = d3.scaleBand()
    .range([height, 0])

d3.csv("{% static 'lm_test/temp.csv' %}", function(error, data) {
    if (error) throw error;
    console.log(data);
    Object.keys(data).ForEach(function(d) { // Currently wont work as data is an object
        d.Year = +d.Year;
    });

    x.domain(data.map(function(d) {return d.Count;}));
    y.domain(data.map(function(d) {return d.Year;}));

    svg.selectAll(".bar")
    .data(data)
    .enter().append("rect")
    .attr("class", "bar")
    .attr("x", function(d) {return x(d.Count); })
    .attr("width", x.bandwidth())
    .attr("y", function(d) {return y(d.Year); })
    .attr("height", function(d) {return height - y(d.Year); });

});
</script>

<div id="visualization"></div>
{% endblock content %}